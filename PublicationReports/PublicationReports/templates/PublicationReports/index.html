{% extends 'PublicationReports/root.html' %}
{% load static %}

{% block body_content %}
{% if perms.catalog.can_add_teacher %}
<form action="{% url 'create_teacher' %}" method="get">
    {% csrf_token %}
    <button type="submit" class="btn btn-primary d-inline-flex align-items-center">Добавить преподавателя</button>
</form>
{% endif %}
<table>
    <tr>
        <td>
            <table>
                <tr>
                    <th>ФИО</th>
                </tr>
                <tr>
                    {% for author in authors %}
                    <td><a class="link-primary link-offset-2 link-underline-opacity-25 link-underline-opacity-100-hover"
                           href="{% url 'view_author' author.id %}">{{ author.name }}</a></td>
                <tr>
                </tr>
                {% endfor %}
            </table>
        </td>
        <td>
            <table>
                <tr>
                    <th>Кафедра</th>
                </tr>
                <tr>
                    {% for d in depart %}
                    <td>{{ d.name }}</td>
                <tr>
                </tr>
                {% endfor %}
            </table>
        </td>
        <td>
            <table>
                <tr>
                    <th>Количество публикаций</th>
                </tr>
                <tr>
                    {% for p in pcount %}
                    <td>
                        {{ p }}
                    </td>
                <tr>
                </tr>
                {% endfor %}
            </table>
        </td>
    </tr>
</table>

<canvas id="myChart" width="50" height="5"></canvas>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    const ctx = document.getElementById('myChart').getContext('2d');
    const myChart = new Chart(ctx, {
        type: 'bar',
        data: {
          labels : [{% for a in authors %}"{{ a.name }}",{% endfor %}],
            datasets: [{
              label: "Количество публикаций преподавателя",
              data : [{% for p in pcount %}{{ p }},{% endfor %}],
              backgroundColor: 'rgba(75, 192, 192, 0.2)',
              borderColor: 'rgba(75, 192, 192, 1)',
              borderWidth: 1
            }]
        },
        options: {
            scales: {
                y: {
                    beginAtZero: true
                }
            }
        }
    });
</script>

{% endblock body_content %}